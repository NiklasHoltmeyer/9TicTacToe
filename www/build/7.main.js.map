{"version":3,"sources":["../../src/pages/lobby/lobby.module.ts","../../src/pages/lobby/lobby.ts"],"names":[],"mappings":"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","file":"7.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LobbyPage } from './lobby';\n\n@NgModule({\n  declarations: [\n    LobbyPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LobbyPage),\n  ],\n  exports: [\n    LobbyPage\n  ]\n})\nexport class LobbyPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/lobby/lobby.module.ts","import { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { Component, NgZone } from '@angular/core';\r\n// import { GamePage } from '../game/game';\r\nimport { GamestatusProvider } from '../../providers/gamestatus/gamestatus';\r\nimport { AuthProvider } from '../../providers/auth/auth';\r\nimport { FirebaseProvider } from '../../providers/firebase/firebase';\r\n\r\n/**\r\n * Generated class for the LobbyPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n@IonicPage({\r\n  name: 'LobbyPage'\r\n})\r\n@Component({\r\n  selector: 'page-lobby',\r\n  templateUrl: 'lobby.html',\r\n})\r\nexport class LobbyPage {\r\n  created: boolean = false;\r\n  lobbys = [];\r\n  gameType;\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, public db: FirebaseProvider, public auth: AuthProvider, public gameStatus: GamestatusProvider, public zone: NgZone) {\r\n    this.gameType = this.navParams.get('type');\r\n  }\r\n  ionViewDidLoad() { }\r\n\r\n  ionViewWillEnter() {\r\n    this.db.listenToOpenLobbys();\r\n    this.db.openLobbys.subscribe((snap) => {\r\n      this.zone.run(() => {\r\n        this.lobbys.push({ key: snap.getKey(), name: snap.val().creator_displayName });\r\n      });\r\n    }, (err) => {\r\n      alert(\"Lobby - ionViewWillEnter(): \" + err);\r\n    });\r\n  }\r\n  ionViewWillLeave() {\r\n    this.db.stopListenToOpenLobbys();\r\n  }\r\n\r\n  enterGame(playerturn, key): void {\r\n    /* playerturn  true == (Lobby)ersteller, joiner == false */\r\n    let setupInfos: any = (playerturn) ? { // nur ersteller init die lobby in firebase\r\n      turn: true,\r\n      won_fields: this.gameStatus.won_fields,\r\n      fields: this.gameStatus.fields,\r\n      nextField: this.gameStatus.nextfield,\r\n      speedUpTimer: 30\r\n    } : false;\r\n    this.db.setUpLobby(key, setupInfos)\r\n      .then((snap: any) => {\r\n        this.gameStatus.initMultiplayer(key);\r\n        this.gameStatus.gameType = 2;\r\n        this.gameStatus.players[0].name = snap.val().creator_displayName;\r\n        this.gameStatus.players[0].uid = snap.val().creator_uid;\r\n        this.gameStatus.players[1].name = snap.val().joiner_displayName;\r\n        this.gameStatus.players[1].uid = snap.val().joiner_uid;\r\n        \r\n        this.gameStatus.symbol = playerturn;\r\n        this.navCtrl.push(\"GamePage\");\r\n      })\r\n      .catch((err) => {\r\n        alert(\"Lobby enterGame: \" + err);\r\n      })\r\n\r\n  }\r\n\r\n  createLobby(): void {\r\n    const lobbyInfos = {\r\n      creator_uid: this.auth.getUserUid(),\r\n      creator_displayName: this.auth.getdisplayName(),\r\n      state: 1, // open\r\n      state_creator_uid: \"1_\" + this.auth.getUserUid() //fÃ¼r uniqueLobby || quelle: https://www.youtube.com/watch?v=sKFLI5FOOHs&feature=youtu.be})\r\n    };\r\n    this.db.createLobby(lobbyInfos).then((key) => { \r\n      this.db.joinedLobby.subscribe((snap) => {\r\n        if (snap) this.enterGame(true, key); // wird aufgerufen wenn jemand der lobby beitritt \r\n      },\r\n        (err) => {\r\n          console.log(\"createLobby: \" + err);\r\n        });\r\n      this.db.waitLobby(key); // listener starten ^ \r\n    });\r\n  }\r\n\r\n  createGame(): void {\r\n    this.db.isUniqueLobby().then(snap=>{\r\n      this.createLobby();\r\n    }).catch(err=>{\r\n      alert(\"Just one Lobby per Person\");\r\n    });\r\n  }\r\n\r\n  joinGame(key): void {\r\n    this.db.joinLobby(key)\r\n    .then(()=>this.enterGame(false, key))\r\n    .catch((err)=>alert(err));\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/lobby/lobby.ts"],"sourceRoot":""}